{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["D:/Self Project/Smart EV Charging Optimization Platform/frontend/src/app/page.tsx"],"sourcesContent":["\"use client\";\nimport React, { useState } from \"react\";\nimport { LineChart, Line, XAxis, YAxis, Tooltip, CartesianGrid, ResponsiveContainer } from \"recharts\";\n\nexport default function Home() {\n  const [battery, setBattery] = useState(20);\n  const [power, setPower] = useState(7);\n  const [departure, setDeparture] = useState(\"14:10\");\n  const [cheapMode, setCheapMode] = useState(false);\n\n  const [result, setResult] = useState(null);\n  const [countdown, setCountdown] = useState(\"\");\n\n  // -----------------------------\n  // Countdown – 依据后端 end_time => HH:MM\n  // -----------------------------\n  const calculateCountdown = (endTimeStr) => {\n    const now = new Date();\n    const [h, m] = endTimeStr.split(\":\").map(Number);\n\n    const end = new Date();\n    end.setHours(h, m, 0, 0);\n\n    if (end <= now) {\n      end.setDate(end.getDate() + 1);\n    }\n\n    const diff = end - now;\n    const hrs = Math.floor(diff / 3600000);\n    const mins = Math.floor((diff % 3600000) / 60000);\n\n    return `${hrs}h ${mins}m`;\n  };\n\n  // -----------------------------\n  // Handle Optimize\n  // -----------------------------\n  const handleOptimize = async () => {\n    setResult(null);\n\n    try {\n      const res = await fetch(\"http://localhost:8000/predict\", {\n        method: \"POST\",\n        headers: { \"Content-Type\": \"application/json\" },\n        body: JSON.stringify({\n          battery_level: battery,\n          charger_power: power,\n          target_time: departure,\n          cheap_mode: cheapMode,\n          target_soc: 80,\n        }),\n      });\n\n      const data = await res.json();\n      if (!res.ok) throw new Error(data.error || \"Request failed\");\n\n      // 保存 backend 返回的结果\n      setResult(data);\n\n      // 使用后端给的 end_time 来算 countdown（正确）\n      setCountdown(calculateCountdown(data.end_time));\n\n    } catch (err) {\n      alert(\"⚠️ Backend error\");\n    }\n  };\n\n  // -----------------------------\n  // Charging Needed 由后端 hours 直接显示\n  // -----------------------------\n  const renderChargingInfo = () => {\n    if (!result) return null;\n\n    return (\n      <div className=\"p-4 border rounded bg-gray-100\">\n        <p><b>Charging Needed:</b> {result.hours.toFixed(2)} h</p>\n        <p><b>Start Time:</b> {result.start_time}</p>\n        <p><b>End Time:</b> {result.end_time}</p>\n        <p><b>Countdown:</b> {countdown}</p>\n      </div>\n    );\n  };\n\n  // -----------------------------\n  // Timeline 图表（直接用后端 timeline）\n  // -----------------------------\n  const renderChart = () => {\n    if (!result?.timeline) return null;\n\n    // 格式符合 Recharts 需要\n    const chartData = result.timeline.map((p) => ({\n      time: p.time,\n      soc: p.soc,\n    }));\n\n    return (\n      <ResponsiveContainer width=\"100%\" height={300}>\n        <LineChart data={chartData}>\n          <CartesianGrid strokeDasharray=\"3 3\" />\n\n          <XAxis dataKey=\"time\" />\n          <YAxis domain={[0, 100]} />\n          <Tooltip />\n\n          <Line type=\"monotone\" dataKey=\"soc\" stroke=\"#8884d8\" strokeWidth={2} dot={false} />\n        </LineChart>\n      </ResponsiveContainer>\n    );\n  };\n\n  // -----------------------------\n  // UI\n  // -----------------------------\n  return (\n    <div className=\"p-6 max-w-2xl mx-auto space-y-6\">\n\n      <h1 className=\"text-xl font-bold\">EV Charging Optimizer</h1>\n\n      {/* Inputs */}\n      <div className=\"space-y-4\">\n\n        <div>\n          <label>Battery Level (%)</label>\n          <input type=\"number\" value={battery}\n            className=\"block w-full border p-2\"\n            onChange={(e) => setBattery(Number(e.target.value))} />\n        </div>\n\n        <div>\n          <label>Charger Power (kW)</label>\n          <input type=\"number\" value={power}\n            className=\"block w-full border p-2\"\n            onChange={(e) => setPower(Number(e.target.value))} />\n        </div>\n\n        <div>\n          <label>Departure Time</label>\n          <input type=\"time\" value={departure}\n            className=\"block w-full border p-2\"\n            onChange={(e) => setDeparture(e.target.value)} />\n        </div>\n\n        <div>\n          <label className=\"flex gap-2 items-center\">\n            <input type=\"checkbox\"\n              checked={cheapMode}\n              onChange={(e) => setCheapMode(e.target.checked)} />\n            Optimize by Electricity Cost\n          </label>\n        </div>\n\n        <button\n          onClick={handleOptimize}\n          className=\"bg-blue-600 text-white px-4 py-2 rounded\"\n        >\n          Calculate\n        </button>\n\n      </div>\n\n      {/* Output */}\n      {renderChargingInfo()}\n      {renderChart()}\n\n    </div>\n  );\n}\n"],"names":["React","useState","LineChart","Line","XAxis","YAxis","Tooltip","CartesianGrid","ResponsiveContainer","Home","battery","setBattery","power","setPower","departure","setDeparture","cheapMode","setCheapMode","result","setResult","countdown","setCountdown","calculateCountdown","endTimeStr","now","Date","h","m","split","map","Number","end","setHours","setDate","getDate","diff","hrs","Math","floor","mins","handleOptimize","res","fetch","method","headers","body","JSON","stringify","battery_level","charger_power","target_time","cheap_mode","target_soc","data","json","ok","Error","error","end_time","err","alert","renderChargingInfo","hours","toFixed","start_time","renderChart","timeline","chartData","p","time","soc","e","target","value","checked"],"mappings":"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","ignoreList":[]}}]
}